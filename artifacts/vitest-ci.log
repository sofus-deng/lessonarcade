
> lessonarcade@0.1.0 test /Users/eichi/World/Engine/Code/LessonArcade
> vitest run


[1m[46m RUN [49m[22m [36mv4.0.16 [39m[90m/Users/eichi/World/Engine/Code/LessonArcade[39m

[90mstderr[2m | test/studio/proxy-basic-auth.test.ts[2m > [22m[2mStudio Proxy Basic Auth[2m > [22m[2mwhen Basic Auth credentials are NOT configured[2m > [22m[2mshould allow access to /studio/voice-analytics without credentials in development
[22m[39mStudio Basic Auth credentials not configured. Allowing access for development.

 [32mâœ“[39m test/studio/proxy-basic-auth.test.ts [2m([22m[2m10 tests[22m[2m)[22m[32m 8[2mms[22m[39m
 [32mâœ“[39m test/voice/analytics.test.ts [2m([22m[2m24 tests[22m[2m)[22m[32m 15[2mms[22m[39m
[90mstderr[2m | test/voice/telemetry.test.ts[2m > [22m[2mVoice Telemetry[2m > [22m[2mJSONL Append Behavior[2m > [22m[2mshould handle missing directory gracefully
[22m[39mFailed to append telemetry event: Error: Directory creation failed
    at [90m/Users/eichi/World/Engine/Code/LessonArcade/[39mtest/voice/telemetry.test.ts:275:41
[90m    at processTicksAndRejections (node:internal/process/task_queues:103:5)[39m
    at [90mfile:///Users/eichi/World/Engine/Code/LessonArcade/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.16/node_modules/[4m@vitest/runner[24m/dist/index.js:915:20

[90mstderr[2m | test/voice/telemetry.test.ts[2m > [22m[2mVoice Telemetry[2m > [22m[2mError Handling[2m > [22m[2mshould handle telemetry failures gracefully
[22m[39mFailed to append telemetry event: Error: File system error
    at [90m/Users/eichi/World/Engine/Code/LessonArcade/[39mtest/voice/telemetry.test.ts:344:46
[90m    at processTicksAndRejections (node:internal/process/task_queues:103:5)[39m
    at [90mfile:///Users/eichi/World/Engine/Code/LessonArcade/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.16/node_modules/[4m@vitest/runner[24m/dist/index.js:915:20

 [32mâœ“[39m test/voice/telemetry.test.ts [2m([22m[2m14 tests[22m[2m)[22m[32m 22[2mms[22m[39m
 [32mâœ“[39m test/studio/voice-analytics-import-guards.test.ts [2m([22m[2m13 tests[22m[2m)[22m[32m 8[2mms[22m[39m
 [32mâœ“[39m test/voice/analytics-privacy.test.ts [2m([22m[2m6 tests[22m[2m)[22m[32m 17[2mms[22m[39m
 [32mâœ“[39m test/voice/build-script.test.ts [2m([22m[2m13 tests[22m[2m)[22m[32m 6[2mms[22m[39m
 [32mâœ“[39m test/demo/demo-lessons-validation.test.ts [2m([22m[2m50 tests[22m[2m)[22m[32m 17[2mms[22m[39m
[90mstderr[2m | test/voice/telemetry-endpoint.test.ts[2m > [22m[2mTelemetry Endpoint[2m > [22m[2mPOST /api/voice/telemetry[2m > [22m[2mshould handle server errors gracefully
[22m[39mTelemetry endpoint error: Error: Server error
    at Object.<anonymous> [90m(/Users/eichi/World/Engine/Code/LessonArcade/[39mtest/voice/telemetry-endpoint.test.ts:159:15[90m)[39m
    at Object.Mock [as checkLimit] [90m(file:///Users/eichi/World/Engine/Code/LessonArcade/[39mnode_modules/[4m.pnpm[24m/@vitest+spy@4.0.16/node_modules/[4m@vitest/spy[24m/dist/index.js:285:34[90m)[39m
    at Module.POST [90m(/Users/eichi/World/Engine/Code/LessonArcade/[39mapp/api/voice/telemetry/route.ts:11:50[90m)[39m
    at [90m/Users/eichi/World/Engine/Code/LessonArcade/[39mtest/voice/telemetry-endpoint.test.ts:183:30
    at [90mfile:///Users/eichi/World/Engine/Code/LessonArcade/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.16/node_modules/[4m@vitest/runner[24m/dist/index.js:145:11
    at [90mfile:///Users/eichi/World/Engine/Code/LessonArcade/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.16/node_modules/[4m@vitest/runner[24m/dist/index.js:915:26
    at [90mfile:///Users/eichi/World/Engine/Code/LessonArcade/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.16/node_modules/[4m@vitest/runner[24m/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///Users/eichi/World/Engine/Code/LessonArcade/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.16/node_modules/[4m@vitest/runner[24m/dist/index.js:1209:10[90m)[39m
    at [90mfile:///Users/eichi/World/Engine/Code/LessonArcade/[39mnode_modules/[4m.pnpm[24m/@vitest+runner@4.0.16/node_modules/[4m@vitest/runner[24m/dist/index.js:1653:37

[90mstderr[2m | test/voice/telemetry-endpoint.test.ts[2m > [22m[2mTelemetry Endpoint[2m > [22m[2mPOST /api/voice/telemetry[2m > [22m[2mshould not expose stack traces or internal errors
[22m[39mTelemetry endpoint error: Error: Internal error
    at test.js:123:45

 [32mâœ“[39m test/voice/telemetry-endpoint.test.ts [2m([22m[2m6 tests[22m[2m)[22m[32m 27[2mms[22m[39m
[90mstderr[2m | test/lessonarcade/lesson-load-error-view.test.tsx[2m > [22m[2mLessonLoadErrorView[2m > [22m[2mrenders the correct title for not_found kind
[22m[39mAn update to Root inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

[90mstderr[2m | test/lessonarcade/lesson-load-error-view.test.tsx[2m > [22m[2mLessonLoadErrorView[2m > [22m[2mrenders the correct title for not_found kind
[22m[39mAn update to Root inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

[90mstderr[2m | test/lessonarcade/lesson-load-error-view.test.tsx[2m > [22m[2mLessonLoadErrorView[2m > [22m[2mrenders the correct title for schema_invalid kind
[22m[39mAn update to Root inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

[90mstderr[2m | test/lessonarcade/lesson-load-error-view.test.tsx[2m > [22m[2mLessonLoadErrorView[2m > [22m[2mrenders the correct title for schema_invalid kind
[22m[39mAn update to Root inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

[90mstderr[2m | test/lessonarcade/lesson-load-error-view.test.tsx[2m > [22m[2mLessonLoadErrorView[2m > [22m[2mhides debug details by default in production mode
[22m[39mAn update to Root inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

[90mstderr[2m | test/lessonarcade/lesson-load-error-view.test.tsx[2m > [22m[2mLessonLoadErrorView[2m > [22m[2mhides debug details by default in production mode
[22m[39mAn update to Root inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

[90mstderr[2m | test/lessonarcade/lesson-load-error-view.test.tsx[2m > [22m[2mLessonLoadErrorView[2m > [22m[2mshows debug details when debug prop is true
[22m[39mAn update to Root inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

[90mstderr[2m | test/lessonarcade/lesson-load-error-view.test.tsx[2m > [22m[2mLessonLoadErrorView[2m > [22m[2mshows debug details when debug prop is true
[22m[39mAn update to Root inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

[90mstderr[2m | test/lessonarcade/lesson-load-error-view.test.tsx[2m > [22m[2mLessonLoadErrorView[2m > [22m[2mrenders the 'Back to Demos' button with correct link
[22m[39mAn update to Root inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

 [32mâœ“[39m test/voice/rate-limiter-minute.test.ts [2m([22m[2m8 tests[22m[2m)[22m[32m 10[2mms[22m[39m
[90mstderr[2m | test/lessonarcade/lesson-load-error-view.test.tsx[2m > [22m[2mLessonLoadErrorView[2m > [22m[2mrenders the 'Back to Demos' button with correct link
[22m[39mAn update to Root inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

 [32mâœ“[39m test/lessonarcade/lesson-load-error-view.test.tsx [2m([22m[2m5 tests[22m[2m)[22m[32m 230[2mms[22m[39m
 [32mâœ“[39m test/presskit/presskit.test.ts [2m([22m[2m8 tests[22m[2m)[22m[33m 553[2mms[22m[39m
[90mstderr[2m | test/voice/voice-chat-flow-ui.test.tsx[2m > [22m[2mVoice Chat Flow UI[2m > [22m[2mrenders without crashing
[22m[39mAn update to Root inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

[90mstderr[2m | test/voice/voice-chat-flow-ui.test.tsx[2m > [22m[2mVoice Chat Flow UI[2m > [22m[2mrenders without crashing
[22m[39mAn update to Root inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

[90mstderr[2m | test/voice/voice-chat-flow-ui.test.tsx[2m > [22m[2mVoice Chat Flow UI[2m > [22m[2mdoes not autoplay on mount
[22m[39mAn update to Root inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

[90mstderr[2m | test/voice/voice-chat-flow-ui.test.tsx[2m > [22m[2mVoice Chat Flow UI[2m > [22m[2mdoes not autoplay on mount
[22m[39mAn update to Root inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

[90mstderr[2m | test/voice/voice-chat-flow-ui.test.tsx[2m > [22m[2mVoice Chat Flow UI[2m > [22m[2mdoes not persist specific answers in localStorage
[22m[39mAn update to Root inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

[90mstderr[2m | test/voice/voice-chat-flow-ui.test.tsx[2m > [22m[2mVoice Chat Flow UI[2m > [22m[2mdoes not persist specific answers in localStorage
[22m[39mAn update to Root inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

 [32mâœ“[39m test/voice/voice-chat-flow-ui.test.tsx [2m([22m[2m3 tests[22m[2m)[22m[32m 24[2mms[22m[39m
 [32mâœ“[39m test/voice/presets.test.ts [2m([22m[2m21 tests[22m[2m)[22m[32m 8[2mms[22m[39m
 [32mâœ“[39m test/demo/design-feedback-lesson.test.ts [2m([22m[2m8 tests[22m[2m)[22m[32m 10[2mms[22m[39m
 [32mâœ“[39m test/lessonarcade/loaders-by-slug.test.ts [2m([22m[2m3 tests[22m[2m)[22m[32m 13[2mms[22m[39m
 [32mâœ“[39m test/voice/tts-dedupe.test.ts [2m([22m[2m8 tests[22m[2m)[22m[32m 15[2mms[22m[39m
 [32mâœ“[39m test/voice/chunk-text.test.ts [2m([22m[2m14 tests[22m[2m)[22m[32m 5[2mms[22m[39m
 [32mâœ“[39m test/voice/chat-flow.test.ts [2m([22m[2m10 tests[22m[2m)[22m[32m 3[2mms[22m[39m
 [32mâœ“[39m test/voice/telemetry-emitter.test.ts [2m([22m[2m3 tests[22m[2m)[22m[32m 3[2mms[22m[39m
 [32mâœ“[39m test/scripts/cloud-run-smoke.test.ts [2m([22m[2m1 test[22m[2m)[22m[32m 1[2mms[22m[39m
 [32mâœ“[39m test/demo/demo-lesson-grid-link.test.ts [2m([22m[2m1 test[22m[2m)[22m[32m 1[2mms[22m[39m
 [32mâœ“[39m test/lessonarcade/lesson-load-error.test.ts [2m([22m[2m6 tests[22m[2m)[22m[32m 3[2mms[22m[39m
 [32mâœ“[39m test/smoke.test.ts [2m([22m[2m3 tests[22m[2m)[22m[32m 1[2mms[22m[39m

[2m Test Files [22m [1m[32m23 passed[39m[22m[90m (23)[39m
[2m      Tests [22m [1m[32m238 passed[39m[22m[90m (238)[39m
[2m   Start at [22m 19:43:12
[2m   Duration [22m 1.83s[2m (transform 875ms, setup 1.76s, import 1.89s, tests 999ms, environment 7.54s)[22m

